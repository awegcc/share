<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/** @module myshare/client */

const _ = require('lodash');
const Path = require('path');
const mime = require('mime');
const merge = require('merge');
const Base = require('myshare-base');
const Core = require('myshare-core');

const DEFAULT_OPTIONS = {
  url: 'https://api.myshare.io',
  logger: Base.Utils.consoleLogger(),
  requestTimeout: 30000,
};

/**
 * present a Myshare client library; if env TESTCLIENT is defined, return a dummy client library
 * @class
 * @param {object} options                      - options
 * @param {string} options.url                  - Myshare server url, default is 'https://api.myshare.io'
 * @param {object} options.logger               - logger
 * @param {string} options.requestTimeout       - client requset timeout, default is 30000
 * @param {object} options.tokenAuth            - token authentication
 * @param {string} options.tokenAuth.token      - token
 * @param {object} options.basicAuth            - HTTP basic authentication
 * @param {string} options.basicAuth.user       - user
 * @param {string} options.basicAuth.password   - password
 * @param {object} options.s3Auth               - AWS S3 auth (support both V2 and V4)
 * @param {string} options.s3Auth.version       - AWS S3 auth version, 2 or 4
 * @param {object} options.s3Auth.data          - AWS S3 auth data
 */
class Client {
  constructor(options) {
    options = options || {};
    options = merge(Object.create(DEFAULT_OPTIONS), options);

    this._logger = options.logger;
    this._options = options;

    this._defaultReqOpts = {
      baseURI: options.url,
      timeout: options.requestTimeout,
      noauth: false,
    };

    if (options.tokenAuth) {
      this._defaultReqOpts.tokenAuth = options.tokenAuth;
    } else if (options.basicAuth) {
      this._defaultReqOpts.basicAuth = options.basicAuth;
    } else if (options.s3Auth) {
      this._defaultReqOpts.s3Auth = options.s3Auth;
    }

  }

  /**
   * send http/s request
   * @function
   * @param opts
   * @param callback
   * @returns {*}
   * @private
   */
  _send(opts, callback) {
    if (process.env.TESTCLIENT) {
      return callback(null, {});
    }

    if (opts.auth) {
      if (opts.auth.token) {
        opts.tokenAuth = opts.auth;
      } else if (opts.auth.user) {
        opts.basicAuth = opts.auth;
      } else if (opts.auth.version) {
        opts.s3Auth = opts.auth;
      }
    }
    delete opts.auth;

    let op = merge(Object.create(this._defaultReqOpts), opts);

    if (!op.noauth &amp;&amp; !op.tokenAuth &amp;&amp; !op.basicAuth &amp;&amp; op.s3Auth ) {
      return callback(new Error('no authentication, please login first'));
    }

    console.log(op);
    Base.Utils.request(op, callback);
  }

  /**
   * user login
   * @instance
   * @param {string} user
   * @param {string} password
   * @param {function} callback - error and {@link Core.Token} if success
   * @returns {*}
   */
  login(user, password, callback) {
    if (!user || !password) {
      return callback('no user or password');
    }

    return this._send({
      method: 'POST',
      path: '/login',
      auth: {
        user: user,
        password: password,
      },
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      let token = new Core.Token(result);

      this._defaultReqOpts.tokenAuth = {
        token: token.id,
      };

      callback(null, token);
    });
  }

  /**
   * user logout
   * @instance
   * @param {function} callback - error
   * @returns {*}
   */
  logout(callback) {
    if (!this._defaultReqOpts.tokenAuth) {
      return callback('not login yet');
    }

    return this._send({
      method: 'POST',
      path: '/logout',
    },(err) => {
      if (err) {
        return callback(err);
      }

      delete this._defaultReqOpts.tokenAuth;

      callback(null);
    });
  }

  /**
   * register a new user
   * @instance
   * @param {string} email
   * @param {string} password
   * @param {function} callback - error and {@link Core.User} if success
   * @returns {*}
   */
  register(email, password, callback) {
    if (!email || !password) {
      return callback('no email or password');
    }

    return this._send({
      method: 'POST',
      path: '/users',
      params: {
        email: email,
        password: Base.Utils.sha256(password, 'utf8'),
      },
      noauth: true,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.User(result));
    });
  }

  /**
   * retrieve user information
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.User} if success
   * @returns {*}
   */
  getUser(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'GET',
      path: '/users',
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.User(result));
    });
  }

  /**
   * delete an user
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  deleteUser(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'DELETE',
      path: '/users',
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * send new user activator
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  reactivateUser(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'POST',
      path: '/users/activations',
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * activate a new user
   * @instance
   * @param {string} activator
   * @param {function} callback - error
   * @returns {*}
   */
  activateUser(activator, callback) {
    if (!activator) {
      return callback('no activator');
    }

    return this._send({
      method: 'POST',
      path: `/users/activations/${activator}`,
      noauth: true,
    },(err) => {
      if (err) {
        return callback(err);
      }
      callback(null);
    });
  }

  /**
   * reset user password
   * @instance
   * @param {string} password - new password
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  resetPassword(password, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!password) {
      return callback('no password');
    }

    return this._send({
      method: 'POST',
      path: '/users/pwdresets',
      params: {
        password: password,
      },
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * confirm user password resetting
   * @instance
   * @param {string} resetter
   * @param {function} callback - error
   * @returns {*}
   */
  confirmResetPassword(resetter, callback) {
    if (!resetter) {
      return callback('no reseter');
    }

    return this._send({
      method: 'GET',
      path: `/users/pwdresets/${resetter}`,
      noauth: true,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * change user password
   * @instance
   * @param {string} password - new password
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  changePassword(password, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!password) {
      return callback('no password');
    }

    return this._send({
      method: 'POST',
      path: '/users/pwdchanges',
      params: {
        password: password,
      },
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * get user's balance
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Balance} if success
   * @returns {*}
   */
  getBalance(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'GET',
      path: '/balance',
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Balance(result));
    });
  }

  /**
   * perform a user withdraw
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.BalanceOps} if success
   * @returns {*}
   */
  execWithdraw(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'POST',
      path: '/withdraws',
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.BalanceOps(result));

    });
  }

  /**
   * get user withdraws
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.BalanceOps} if success
   * @returns {*}
   */
  getWithdraws(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'GET',
      path: '/withdraws',
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, _.map(result, (item) => {
        return new Core.BalanceOps(item);
      }));
    });
  }

  /**
   * get a user withdraw
   * @instance
   * @param {string} id - withdraw id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.BalanceOps} if success
   * @returns {*}
   */
  getWithdraw(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'GET',
      path: `/withdraws/${id}`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.BalanceOps(result));
    });
  }

  /**
   * cancel a user withdraw
   * @instance
   * @param {string} id - withdraw id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.BalanceOps} if success
   * @returns {*}
   */
  cancelWithdraw(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'DELETE',
      path: `/withdraws/${id}`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.BalanceOps(result));
    });
  }

  /**
   * create a bucket
   * @instance
   * @param {string} name - bucket name
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Bucket} if success
   * @returns {*}
   */
  createBucket(name, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!name) {
      return callback('no name');
    }

    return this._send({
      method: 'POST',
      path: `/buckets`,
      params: {
        name: name
      },
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Bucket(result));
    });
  }

  /**
   * list buckets of an user
   * @instance
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and array of {@link Core.Bucket} if success
   * @returns {*}
   */
  listBuckets(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'GET',
      path: `/buckets`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, _.map(result, (item) => {
        return new Core.Bucket(item);
      }));
    });
  }

  /**
   * get a bucket
   * @instance
   * @param {string} id - bucket id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Bucket} if success
   * @returns {*}
   */
  getBucket(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'GET',
      path: `/buckets/${id}`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Bucket(result));
    });
  }

  /**
   * get a bucket
   * @instance
   * @param {string} id - bucket id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  deleteBucket(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'DELETE',
      path: `/buckets/${id}`,
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * prepare file readiness for downloading it
   * @private
   * @param {string} bucketid - bucket id
   * @param {string} fileid - file id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.File} if success
   * @returns {*}
   */
  _getFileReadiness(bucketid, fileid, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    if (!fileid) {
      return callback('no fileid');
    }

    return this._send({
      method: 'GET',
      path: `/buckets/${bucketid}/files/${fileid}`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.File(result));
    });
  }

  /**
   * create a file
   * @private
   * @param {string} bucketid - bucket id
   * @param {string} filename - file name
   * @param {string} layer - layer to be linked to this file
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.File} if success
   * @returns {*}
   */
  _createFile(bucketid, filename, layer, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    if (!filename) {
      return callback('no filename');
    }

    if (!layer) {
      return callback('no layer');
    }

    return this._send({
      method: 'POST',
      path: `/buckets/${bucketid}/files`,
      params: {
        filename: filename,
        layer: layer,
        mimetype: mime.getType(filename),
      },
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.File(result));
    });
  }

  /**
   * create a file layer
   * @private
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Layer} if success
   * @returns {*}
   */
  _createFileLayer(auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    return this._send({
      method: 'POST',
      path: `/layers`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Layer(result));
    });
  }

  /**
   * get a file layer
   * @private
   * @param {string} id - layer id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Layer} if success
   * @returns {*}
   */
  _getFileLayer(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id ) {
      return callback('no layer id');
    }

    return this._send({
      method: 'GET',
      path: `/layers/${id}`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Layer(result));
    });
  }

  /**
   * delete a file layer
   * @private
   * @param {string} id - layer id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  _deleteFileLayer(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id ) {
      return callback('no layer id');
    }

    return this._send({
      method: 'DELETE',
      path: `/layers/${id}`,
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * add a block to a file layer
   * @private
   * @param {object} block - {@link Core.LBlock}
   * @param {string} layer - layer
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and object of {hash, token, operation, layer} if success
   * @returns {*}
   */
  _addBlockToFileLayer(block, layer, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!block || !(block instanceof Core.LBlock)) {
      return callback('invalid file block');
    }

    if (!layer ) {
      return callback('no layer');
    }

    return this._send({
      method: 'POST',
      path: `/layers/${layer}/blocks`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, {
        hash: result.hash,
        token: result.token,
        operation: result.operation,
        layer: new Core.Layer(result.layer),
      });
    });
  }

  /**
   * list files
   * @instance
   * @param {string} bucketid - bucket id
   * @param {object} query - search query
   * @param {date} query.startDate - files match created date is
   * @param {date} query.startAfter - files match created date after
   * @param {string} query.prefix - files name with prefix
   * @param {string} query.delimiter - files name with delimiter
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and array of {@link Core.File} if success
   * @returns {*}
   */
  listFiles(bucketid, query, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucket id');
    }

    query = query || {};

    return this._send({
      method: 'GET',
      path: `/buckets/${bucketid}/files`,
      auth: auth,
      params: {
        startDate: query.startDate || undefined,
        startAfter: query.startAfter || undefined,
        prefix: query.prefix || undefined,
        delimiter: query.delimiter || undefined,
      },
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, _.map(result, (item) => {
        return new Core.File(item);
      }));
    });
  }

  /**
   * head a file
   * @instance
   * @param {string} bucketid - bucket id
   * @param {string} fileid - file id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.File} if success
   * @returns {*}
   */
  headFile(bucketid, fileid, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucket id');
    }

    if (!fileid) {
      return callback('no file id');
    }

    return this._send({
      method: 'GET',
      path: `/buckets/${bucketid}/files/${fileid}/info`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.File(result));
    });
  }

  /**
   * delete a file
   * @instance
   * @param {string} bucketid - bucket id
   * @param {string} fileid - file id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  deleteFile(bucketid, fileid, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucket id');
    }

    if (!fileid) {
      return callback('no file id');
    }

    return this._send({
      method: 'DELETE',
      path: `/buckets/${bucketid}/files/${fileid}`,
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);
    });
  }

  /**
   * read a file
   * @instance
   * @param {string} bucketid - bucket id
   * @param {string} fileid - file id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and readable stream if success
   * @returns {*}
   */
  readFile(bucketid, fileid, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
      auth = undefined;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    if (!fileid) {
      return callback('no fileid');
    }

    this._getFileReadiness(bucketid, fileid, auth, (err, file) => {
      if (err) {
        return callback(err);
      }

      // retrieve file blocks from miners
      let stream = null;

      callback(null, stream);
    });
  }

  /**
   * read a file by range
   * @instance
   * @param {string} bucketid - bucket id
   * @param {string} fileid - file id
   * @param {object} range
   * @param {object} range.start - start position
   * @param {object} range.end - end position
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and readable stream if success
   * @returns {*}
   */
  readFileRange(bucketid, fileid, range, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
      auth = undefined;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    if (!fileid) {
      return callback('no fileid');
    }

    if (!range) {
      return callback('no range');
    }

    this._getFileReadiness(bucketid, fileid, auth, (err, file) => {
      if (err) {
        return callback(err);
      }

      // retrieve file blocks from miners
      let stream = null;

      callback(null, stream);
    });
  }

  /**
   * write a file
   * @instance
   * @param {string} bucketid - bucket id
   * @param {string} filepath - local file path
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.File} if success
   * @returns {*}
   */
  writeFile(bucketid, filepath, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
      auth = undefined;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    if (!filepath) {
      return callback('no file path');
    }

    let filename = Path.basename(filepath);
    let layer = 'layer';

    this._createFile(bucketid, filename, layer, auth, (err, file) => {
      if (err) {
        return callback(err);
      }

      callback(null, file);
    });
  }

  /**
   * create a new upload
   * @instance
   * @param {string} bucketid - bucket id
   * @param {string} filename - file name
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Upload} if success
   * @returns {*}
   */
  createUpload(bucketid, filename, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    if (!filename) {
      return callback('no filename');
    }

    return this._send({
      method: 'POST',
      path: `/uploads`,
      auth: auth,
      params: {
        bucket: bucketid,
        filename: filename,
        mimetype: mime.getType(filename),
      }
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Upload(result));
    });
  }

  /**
   * list uploads by bucket
   * @instance
   * @param {string} bucketid - bucket id
   * @param {object} query - list query
   * @param {string} query.keyMarker - query keyMarker
   * @param {string} query.uploadidMarker - query uploadidMarker
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and array of {@link Core.Update} if success
   * @returns {*}
   */
  listUploads(bucketid, query, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!bucketid) {
      return callback('no bucketid');
    }

    query = query || {};

    return this._send({
      method: 'GET',
      path: `/uploads`,
      auth: auth,
      params: {
        bucket: bucketid,
        keyMarker: query.keyMarker || undefined,
        uploadidMarker: query.uploadidMarker || undefined,
      },
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, _.map(result, (item) => {
        return new Core.Upload(item);
      }));
    });
  }

  /**
   * get an upload
   * @instance
   * @param {string} id - upload id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.Update} if success
   * @returns {*}
   */
  getUpload(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'GET',
      path: `/uploads/${id}`,
      auth: auth,
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.Upload(result));

    });
  }

  /**
   * abort an upload
   * @instance
   * @param {string} id - upload id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  abortUpload(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'DELETE',
      path: `/uploads/${id}`,
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);

    });
  }

  /**
   * complete an upload
   * @instance
   * @param {string} id - upload id
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error
   * @returns {*}
   */
  completeUpload(id, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    return this._send({
      method: 'POST',
      path: `/uploads/${id}`,
      auth: auth,
    },(err) => {
      if (err) {
        return callback(err);
      }

      callback(null);

    });
  }

  /**
   * add part to an upload
   * @instance
   * @param {string} id - upload id
   * @param {number} partnum - upload part number (index)
   * @param {string} layer - data layer
   * @param {object} auth - optional, customized auth
   * @param {function} callback - error and {@link Core.UploadPart} if success
   * @returns {*}
   */
  addPartToUpload(id, partnum, layer, auth, callback) {
    if (typeof auth === 'function') {
      callback = auth;
    }

    if (!id) {
      return callback('no id');
    }

    if (isNaN(partnum)) {
      return callback('no partnum');
    }

    if (!layer) {
      return callback('no layer');
    }

    return this._send({
      method: 'POST',
      path: `/uploads/${id}/parts`,
      auth: auth,
      params: {
        partnum: partnum,
        layer: layer,
      },
    },(err, result) => {
      if (err) {
        return callback(err);
      }

      callback(null, new Core.UploadPart(result));

    });
  }

}

module.exports = Client;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-myshare_client.html">myshare/client</a></li></ul><h3>Classes</h3><ul><li><a href="module-myshare_client-Client.html">Client</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Client">Client</a></li><li><a href="global.html#Core">Core</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon May 07 2018 13:22:41 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
